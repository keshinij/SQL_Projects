SQL Data Exploration
  
/*  dataset: https://ourworldindata.org/covid-deaths  */

CREATE DATABASE IF NOT EXISTS covid;
USE covid;

SELECT * 
FROM covid.covid_deaths
WHERE continent IS NOT NULL
ORDER BY 3, 4;                   

/*
Line 7 WHERE continent IS NOT NULL
When we analyse our data in the excel file, we notice that there are null values in continent column. Upon further analysis, we see that the column location which include continent names, for example Africa, South America ... which in turn corresponds to the null value. Therefore, we need to exclude these from our data.
Line 8 With ORDER BY, we don't need to write column name, we can only write the coulmn number 
*/

-- data which we will be using

SELECT location, date, total_cases, new_cases, total_deaths, population
FROM covid.covid_deaths
WHERE continent IS NOT NULL
ORDER BY 1, 2;

SELECT * 
FROM covid_vaccinations
ORDER BY 3, 4;


-- total cases vs total deaths

SELECT location, date, total_cases, total_deaths, ROUND((total_deaths/total_cases)*100,2) AS deathPercentage
FROM covid.covid_deaths
ORDER BY 1, 2;

-- show the likelihood of dying if you contract covid in the United States

SELECT location, date, total_cases, total_deaths, ROUND((total_deaths/total_cases)*100,2) AS deathPercentage
FROM covid.covid_deaths
WHERE location LIKE '%States%'
ORDER BY 1, 2;

-- show what percentage of population were infected with covid

SELECT location, date, total_cases, population, (total_cases/population)*100 AS percentPopulationInfected
FROM covid.covid_deaths
ORDER BY 1, 2;

-- countries with highest infection rate compared to population

SELECT location, population, MAX(total_cases) AS highestInfectionCount, MAX((total_cases/population)*100) AS percentPopulationInfected
FROM covid.covid_deaths
GROUP BY location, population
ORDER BY percentPopulationInfected DESC;




